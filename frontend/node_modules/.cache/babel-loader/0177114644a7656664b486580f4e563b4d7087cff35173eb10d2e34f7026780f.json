{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\vishn\\\\OneDrive\\\\Desktop\\\\live chat\\\\frontend\\\\frontend\\\\src\\\\components\\\\VideoChat.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef } from \"react\";\nimport { io } from \"socket.io-client\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst socket = io(\"http://localhost:3000\");\nexport default function VideoChat() {\n  _s();\n  const localVideo = useRef(null);\n  const remoteVideo = useRef(null);\n  const peer = useRef(null);\n  const localStream = useRef(null);\n  useEffect(() => {\n    async function init() {\n      // 1. Get camera + microphone\n      localStream.current = await navigator.mediaDevices.getUserMedia({\n        video: true,\n        audio: true\n      });\n      localVideo.current.srcObject = localStream.current;\n\n      // 2. Create peer connection\n      peer.current = new RTCPeerConnection({\n        iceServers: [{\n          urls: \"stun:stun.l.google.com:19302\"\n        }]\n      });\n\n      // 3. Add local tracks\n      localStream.current.getTracks().forEach(track => {\n        peer.current.addTrack(track, localStream.current);\n      });\n\n      // 4. When remote video arrives\n      peer.current.ontrack = event => {\n        remoteVideo.current.srcObject = event.streams[0];\n      };\n\n      // 5. Send ICE candidates\n      peer.current.onicecandidate = event => {\n        if (event.candidate) {\n          socket.emit(\"ice-candidate\", event.candidate);\n        }\n      };\n\n      // If this user gets paired → create offer\n      socket.on(\"paired\", async () => {\n        const offer = await peer.current.createOffer();\n        await peer.current.setLocalDescription(offer);\n        socket.emit(\"offer\", offer);\n      });\n\n      // Receive offer\n      socket.on(\"offer\", async offer => {\n        await peer.current.setRemoteDescription(offer);\n        const answer = await peer.current.createAnswer();\n        await peer.current.setLocalDescription(answer);\n        socket.emit(\"answer\", answer);\n      });\n\n      // Receive answer\n      socket.on(\"answer\", async answer => {\n        await peer.current.setRemoteDescription(answer);\n      });\n\n      // Receive ICE candidate\n      socket.on(\"ice-candidate\", async candidate => {\n        try {\n          await peer.current.addIceCandidate(candidate);\n        } catch (err) {\n          console.error(\"ICE Error\", err);\n        }\n      });\n    }\n    init();\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"video-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"video\", {\n      ref: localVideo,\n      autoPlay: true,\n      muted: true,\n      className: \"video\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n      ref: remoteVideo,\n      autoPlay: true,\n      className: \"video\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 83,\n    columnNumber: 5\n  }, this);\n}\n_s(VideoChat, \"d3Fk/davCKzfQKfPHloMXvOVisg=\");\n_c = VideoChat;\nvar _c;\n$RefreshReg$(_c, \"VideoChat\");","map":{"version":3,"names":["React","useEffect","useRef","io","jsxDEV","_jsxDEV","socket","VideoChat","_s","localVideo","remoteVideo","peer","localStream","init","current","navigator","mediaDevices","getUserMedia","video","audio","srcObject","RTCPeerConnection","iceServers","urls","getTracks","forEach","track","addTrack","ontrack","event","streams","onicecandidate","candidate","emit","on","offer","createOffer","setLocalDescription","setRemoteDescription","answer","createAnswer","addIceCandidate","err","console","error","className","children","ref","autoPlay","muted","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/vishn/OneDrive/Desktop/live chat/frontend/frontend/src/components/VideoChat.js"],"sourcesContent":["import React, { useEffect, useRef } from \"react\";\r\nimport { io } from \"socket.io-client\";\r\n\r\nconst socket = io(\"http://localhost:3000\");\r\n\r\nexport default function VideoChat() {\r\n  const localVideo = useRef(null);\r\n  const remoteVideo = useRef(null);\r\n\r\n  const peer = useRef(null);\r\n  const localStream = useRef(null);\r\n\r\n  useEffect(() => {\r\n    async function init() {\r\n      // 1. Get camera + microphone\r\n      localStream.current = await navigator.mediaDevices.getUserMedia({\r\n        video: true,\r\n        audio: true\r\n      });\r\n\r\n      localVideo.current.srcObject = localStream.current;\r\n\r\n      // 2. Create peer connection\r\n      peer.current = new RTCPeerConnection({\r\n        iceServers: [\r\n          { urls: \"stun:stun.l.google.com:19302\" }\r\n        ]\r\n      });\r\n\r\n      // 3. Add local tracks\r\n      localStream.current.getTracks().forEach(track => {\r\n        peer.current.addTrack(track, localStream.current);\r\n      });\r\n\r\n      // 4. When remote video arrives\r\n      peer.current.ontrack = (event) => {\r\n        remoteVideo.current.srcObject = event.streams[0];\r\n      };\r\n\r\n      // 5. Send ICE candidates\r\n      peer.current.onicecandidate = (event) => {\r\n        if (event.candidate) {\r\n          socket.emit(\"ice-candidate\", event.candidate);\r\n        }\r\n      };\r\n\r\n      // If this user gets paired → create offer\r\n      socket.on(\"paired\", async () => {\r\n        const offer = await peer.current.createOffer();\r\n        await peer.current.setLocalDescription(offer);\r\n        socket.emit(\"offer\", offer);\r\n      });\r\n\r\n      // Receive offer\r\n      socket.on(\"offer\", async (offer) => {\r\n        await peer.current.setRemoteDescription(offer);\r\n\r\n        const answer = await peer.current.createAnswer();\r\n        await peer.current.setLocalDescription(answer);\r\n\r\n        socket.emit(\"answer\", answer);\r\n      });\r\n\r\n      // Receive answer\r\n      socket.on(\"answer\", async (answer) => {\r\n        await peer.current.setRemoteDescription(answer);\r\n      });\r\n\r\n      // Receive ICE candidate\r\n      socket.on(\"ice-candidate\", async (candidate) => {\r\n        try {\r\n          await peer.current.addIceCandidate(candidate);\r\n        } catch (err) {\r\n          console.error(\"ICE Error\", err);\r\n        }\r\n      });\r\n    }\r\n\r\n    init();\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"video-container\">\r\n      <video ref={localVideo} autoPlay muted className=\"video\"></video>\r\n      <video ref={remoteVideo} autoPlay className=\"video\"></video>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}